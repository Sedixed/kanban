(self.webpackChunk=self.webpackChunk||[]).push([[143],{4180:(e,t,n)=>{var a={"./index.js":9721};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=s,e.exports=r,r.id=4180},8205:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const a={}},9721:()=>{},1882:(e,t,n)=>{"use strict";n.r(t),n.d(t,{app:()=>a});var a=(0,n(8360).x)(n(4180))},3664:(e,t,n)=>{"use strict";n(1688),n(8066),n(1136),n(7170),n(6140),n(7375),n(1765),n(7796),n(7254),n(1882),n(7145),n(2652),n(7950),n(4891),n(6775),n(4681),n(5556),n(9957),n(7119),n(1231),n(2465)},7950:(e,t)=>{"use strict";t.__esModule=!0,t.createXhrObject=void 0,t.createXhrObject=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject){var e=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"];for(var t in e)try{return new ActiveXObject(e[t])}catch(e){}}return null}},9957:(e,t,n)=>{"use strict";n(8862),t.__esModule=!0;var a=n(7950),r=document.querySelectorAll(".js-invitation"),s=(0,a.createXhrObject)();function i(e,t){var n=e.currentTarget.dataset.invitationId;s.onreadystatechange=function(){!function(e){if(4==s.readyState)if(200==s.status)document.querySelector("div[data-invitation-id='"+e+"']").remove();else{var t=document.querySelector(".failure-flash");null!=t&&t.remove();var n=document.createElement("div");n.setAttribute("class","failure-flash");var a=document.createTextNode(s.getResponseHeader("X-Error-Message"));n.appendChild(a),document.querySelector("h1").after(n)}}(n)},s.open("POST","/invitation/"+t,!0),s.setRequestHeader("X-Requested-With","XMLHttpRequest");var a={id:n};s.send(JSON.stringify(a))}for(var c=0;c<r.length;++c){var o=r[c].querySelector(".js-accept"),u=r[c].querySelector(".js-reject");o.addEventListener("click",(function(e){return i(e,"accept")})),u.addEventListener("click",(function(e){return i(e,"reject")}))}},4891:(e,t,n)=>{"use strict";n(8309),n(2526),n(1817),n(7658),n(9554),n(1539),n(4747),n(3710),n(4812),n(7327),t.__esModule=!0,t.Kanban=t.KanbanColumn=t.KanbanTask=t.KanbanMember=void 0;var a=n(2652),r=n(7119),s=function(e,t,n,a){this.id=e,this.username=t,this.isOwner=n,this.isCurrent=a};t.KanbanMember=s;var i=function(e,t,n,a,r,s){this.id=e,this.name=t,this.description=n,this.limitDate=a,this.assignUsername=r,this.column=s};t.KanbanTask=i;var c=function(){function e(e,t,n){this.name=e,this.offset=t,this.kanban=n,this.tasks=[]}return e.prototype.addTask=function(e,t,n,a,r){var s=new i(e,t,n,a,r,this);return this.tasks.push(s),s},e.prototype.getTaskById=function(e){var t=null;return this.tasks.forEach((function(n){n.id==e&&(t=n)})),t},e}();t.KanbanColumn=c;var o=function(){function e(){this._columns=[],this._members=[],this._currentPopup=null}return e.initFromTemplate=function(t,n){var a=new e;return a._template=t,n.forEach((function(e){a._members.push(new s(+e.dataset.id,e.innerText,"1"===e.dataset.isOwner,"1"===e.dataset.isCurrent))})),t.querySelectorAll("th").forEach((function(e,t){a.addColumn(e.innerText,t)})),t.querySelectorAll(".js-task").forEach((function(e){var t,n=a.getColumnByOffset(+e.dataset.columnOffset).addTask(+e.dataset.taskId,e.dataset.taskName,e.dataset.taskDescription,e.dataset.taskDate?new Date(e.dataset.taskDate):null,null!==(t=e.dataset.taskUser)&&void 0!==t?t:null);a.bindTaskEvents(e,n)})),a},e.prototype.openTaskPopup=function(e){var t=this;this._currentPopup=(0,a.createTaskPopup)(e);var n=this._currentPopup.querySelector(".js-accept"),s=this._currentPopup.querySelector(".js-affect");null!=n&&n.addEventListener("click",(function(e){(0,r.sendTaskAffectRequest)(e,"accept",t.handleAffectResponse.bind(t))})),null!=s&&s.addEventListener("click",(function(e){(0,r.sendTaskAffectRequest)(e,"affect",t.handleAffectResponse.bind(t))}))},e.prototype.addColumn=function(e,t){this._columns.push(new c(e,t,this))},e.prototype.getColumnByOffset=function(e){if(e<0||e>=this._columns.length)throw"Invalid kanban column offset";return this._columns.filter((function(t){return t.offset===e}))[0]},e.prototype.getTaskById=function(e){var t=null;if(this._columns.forEach((function(n){var a=n.getTaskById(e);null!==a&&(t=a)})),null===t)throw"ID de tâche invalide";return t},e.prototype.bindTaskEvents=function(e,t){var n=this;e.addEventListener("click",(function(e){e.target instanceof HTMLAnchorElement||n.openTaskPopup(t)}))},e.prototype.refreshPopup=function(e){var t=this._currentPopup.querySelector("h2"),n=document.createElement("h3");n.textContent="Tâche affectée à : "+e.assignUsername,t.after(n),this._currentPopup.querySelector(".task-actions").remove()},e.prototype.handleAffectResponse=function(e,t){var n=this.getTaskById(e);n.assignUsername=t.name,this.refreshPopup(n)},e.prototype.getTemplate=function(){return this._template},e.prototype.getColumns=function(){return this._columns},e.prototype.getMembers=function(){return this._members},e}();t.Kanban=o},6775:(e,t,n)=>{n(4916),n(5306);var a=function(e){var t=document.createElement("button");t.classList.add("delete-column");var n=document.createTextNode("Supprimer");t.appendChild(n),e.querySelector(".js-input-container").append(t),t.addEventListener("click",(function(t){t.preventDefault(),e.remove()}))},r=document.querySelector(".js-add-item");null!=r&&r.addEventListener("click",(function(){var e=document.querySelector("form .columns"),t=e.querySelector(".js-last-column"),n=document.createElement("li"),r=document.createElement("div");r.classList.add("input-container"),r.classList.add("js-input-container"),r.classList.add("added-column"),n.appendChild(r),r.innerHTML=e.dataset.prototype.replace(/__name__/g,e.dataset.index),n.querySelector("input").setAttribute("placeholder","Nouvelle colonne"),e.insertBefore(n,t),e.dataset.index+=1,a(n)}))},4681:(e,t,n)=>{"use strict";n(7042),t.__esModule=!0;var a=n(7145),r=document.querySelectorAll(".js-sort-options"),s=document.querySelectorAll(".js-kanbans-created .kanban"),i=Array.prototype.slice.call(s,0),c=document.querySelectorAll(".js-kanbans-invited .kanban"),o=Array.prototype.slice.call(c,0);r.length>0&&(s.length>0&&(0,a.bind_events)(r[0],s[0].parentElement,i),c.length>0&&(0,a.bind_events)(r[1],c[0].parentElement,o))},5556:(e,t,n)=>{"use strict";t.__esModule=!0,n(4891).Kanban.initFromTemplate(document.querySelector("table.kanban"),document.querySelectorAll(".js-members li"))},2652:(e,t,n)=>{"use strict";function a(e,t){void 0===t&&(t="Annuler");var n=document.createElement("div");n.classList.add("js-popup-background"),n.classList.add("popup-background"),document.body.appendChild(n);var a=document.createElement("div");a.classList.add("popup");var r=document.createElement("div");r.classList.add("popup-relative"),a.appendChild(r);var s=document.createElement("button");s.classList.add("popup-exit"),s.addEventListener("click",(function(){a.remove(),n.remove()}));var i=document.createTextNode(t);return s.append(i),r.append(e),r.append(s),document.body.append(a),a}function r(e,t,n){var a=document.createElement("div");a.classList.add("input-container"),a.classList.add("form-element-bigger-container");var r=document.createElement("input");r.name=n,r.type=e,"text"===e&&(r.required=!0,r.minLength=3,r.maxLength=255),r.placeholder="";var s=document.createElement("label");return s.textContent=t,a.appendChild(r),a.appendChild(s),a}n(8309),n(4916),n(5306),n(3210),n(2526),n(1817),n(6647),n(3710),n(1539),n(9714),n(7327),n(9554),n(4747),t.__esModule=!0,t.createTaskPopup=t.createNewTaskPopup=void 0,t.createNewTaskPopup=function(e){a(function(e){var t=document.createElement("form");t.action=e,t.method="POST",t.style.margin="0px";var n=r("text","Nom","name"),a=document.createElement("div");a.classList.add("textarea-container"),a.classList.add("form-element-bigger-container");var s=document.createElement("textarea");s.name="description",s.required=!0,s.minLength=3,s.maxLength=500,s.placeholder="Description",a.appendChild(s);var i=r("date","Date limite (optionnelle)","limitDate"),c=document.createElement("button");return c.textContent="Ajouter une tâche",t.appendChild(n),t.appendChild(a),t.appendChild(i),t.appendChild(c),t}("/task/create_under/"+e))},t.createTaskPopup=function(e){var t=document.createElement("div");t.classList.add("task-popup");var n=document.createElement("h2");if(n.textContent=e.name,t.appendChild(n),null!=e.limitDate){var r=document.createElement("span");r.classList.add("limite-date"),r.textContent="Date limite : "+e.limitDate.toLocaleDateString(),t.appendChild(r)}if(null!=e.assignUsername){var s=document.createElement("h3");s.textContent="Tâche assignée à : "+e.assignUsername,t.appendChild(s)}var i=document.createElement("p");if(i.innerHTML=e.description.replace(/(\*\*)(.*?)(\*\*)/gim,'<span class="bold">$2</span>').replace(/(\*)(.*?)(\*)/gim,'<span class="italic">$2</span>').replace(/(__)(.*?)(__)/gim,'<span class="underline">$2</span>').replace(/(~~)(.*?)(~~)/gim,'<span class="deleted">$2</span>').trim(),t.appendChild(i),null===e.assignUsername&&e.column.offset<e.column.kanban.getColumns().length-1){var c=document.createElement("div");c.classList.add("task-actions");var o=document.createElement("button");if(o.classList.add("js-accept"),o.innerText="Accepter",o.dataset.taskId=e.id.toString(),c.appendChild(o),e.column.kanban.getMembers().filter((function(e){return e.isOwner}))[0].isCurrent){var u=document.createElement("div");u.classList.add("affect-container");var l=document.createElement("select");l.name="user",e.column.kanban.getMembers().forEach((function(e){var t=document.createElement("option");t.value=e.id.toString(),t.innerText=e.username,l.appendChild(t)})),u.appendChild(l);var d=document.createElement("button");d.classList.add("js-affect"),d.classList.add("affect-btn"),d.dataset.taskId=e.id.toString(),d.innerText="Affecter",u.appendChild(d),c.appendChild(u)}t.appendChild(c)}return a(t,"Fermer")}},7145:(e,t,n)=>{"use strict";n(3710),n(9554),n(1539),n(4747),n(2707),t.__esModule=!0,t.bind_events=void 0;var a=function(e,t){var n=e.querySelector(".js-alpha-key").textContent,a=t.querySelector(".js-alpha-key").textContent;return n.localeCompare(a)},r=function(e,t){var n=e.querySelector(".js-alpha-dec-key").textContent;return t.querySelector(".js-alpha-dec-key").textContent.localeCompare(n)},s=function(e,t){var n=e.querySelector(".js-date-key"),a=t.querySelector(".js-date-key");if(null==n)return 1;if(null==a)return-1;var r=n.textContent.split("/"),s=a.textContent.split("/"),i=new Date(+r[2],+r[1]-1,+r[0]),c=new Date(+s[2],+s[1]-1,+s[0]);return i.getTime()-c.getTime()},i=function(e,t){var n=e.querySelector(".js-date-dec-key"),a=t.querySelector(".js-date-dec-key");if(null==n)return 1;if(null==a)return-1;var r=n.textContent.split("/"),s=a.textContent.split("/"),i=new Date(+r[2],+r[1]-1,+r[0]);return new Date(+s[2],+s[1]-1,+s[0]).getTime()-i.getTime()},c=function(e,t){for(var n=0;n<e.children.length;n++)e.children[n].remove();for(n=0;n<t.length;++n)e.appendChild(t[n])};t.bind_events=function(e,t,n){var o=e.querySelector(".js-alpha"),u=e.querySelector(".js-alpha-dec"),l=e.querySelector(".js-date"),d=e.querySelector(".js-date-dec"),p=e.querySelector(".kanban-sort");null!=o&&o.addEventListener("click",(function(){n.sort(a),c(t,n)})),null!=u&&u.addEventListener("click",(function(){n.sort(r),c(t,n)})),null!=l&&l.addEventListener("click",(function(){n.sort(s),c(t,n)})),null!=d&&d.addEventListener("click",(function(){n.sort(i),c(t,n)})),null!=p&&n instanceof Array&&p.addEventListener("change",(function(e){var t=+e.target.value;t<0?function(e){e.forEach((function(e){e.classList.remove("invisible")}))}(n):function(e,t){e.forEach((function(e){+e.dataset.kanbanId!==t?e.classList.add("invisible"):e.classList.remove("invisible")}))}(n,t)}))}},2465:(e,t,n)=>{"use strict";n(9554),n(1539),n(4747),t.__esModule=!0;var a=n(2652);document.querySelectorAll(".add-task button").forEach((function(e){e.addEventListener("click",(function(){(0,a.createNewTaskPopup)(+e.dataset.colId)}))}))},7119:(e,t,n)=>{"use strict";n(8862),t.__esModule=!0,t.sendTaskAffectRequest=void 0;var a=(0,n(7950).createXhrObject)();t.sendTaskAffectRequest=function(e,t,n){var r=e.currentTarget,s=r.dataset.taskId;a.onreadystatechange=function(){!function(e,t){if(4==a.readyState)if(200==a.status)t(+e,JSON.parse(a.responseText));else{var n=document.querySelector(".failure-flash");null!=n&&n.remove();var r=document.createElement("div");r.setAttribute("class","failure-flash");var s=document.createTextNode(a.getResponseHeader("X-Error-Message"));r.appendChild(s),document.querySelector(".kanban-title").after(r)}}(s,n)},a.open("POST","/task/"+t,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest");var i={taskId:s};if("affect"===t){var c=r.parentNode.querySelector("select");i.userId=c.value}a.send(JSON.stringify(i))}},1231:(e,t,n)=>{"use strict";n(7042),t.__esModule=!0;var a=n(7145),r=document.querySelectorAll(".js-sort-options"),s=document.querySelectorAll(".tasks .task"),i=Array.prototype.slice.call(s,0);r.length>0&&i.length>0&&(0,a.bind_events)(r[0],i[0].parentElement,i)},1688:(e,t,n)=>{"use strict";n.r(t)},8066:(e,t,n)=>{"use strict";n.r(t)},1136:(e,t,n)=>{"use strict";n.r(t)},7170:(e,t,n)=>{"use strict";n.r(t)},7254:(e,t,n)=>{"use strict";n.r(t)},7375:(e,t,n)=>{"use strict";n.r(t)},6140:(e,t,n)=>{"use strict";n.r(t)},1765:(e,t,n)=>{"use strict";n.r(t)},7796:(e,t,n)=>{"use strict";n.r(t)}},e=>{e.O(0,[535],(()=>{return t=3664,e(e.s=t);var t}));e.O()}]);